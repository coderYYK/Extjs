/** @format */
const datas = [
  {
    instanceRrn: 0,
    instanceId: null,
    lockVersion: 0,
    namedSpace: null,
    instanceDesc: null,
    instanceLongDesc: null,
    object: null,
    objectType: "EQPT",
    objectSubtype: null,
    currentVersion: null,
    activeVersion: null,
    roleRrn: null,
    roleId: null,
    instanceStatus: null,
    createdTimestamp: null,
    lastUpdateTimestamp: null,
    createdTime: null,
    lastUpdateTime: null,
    createdUserRrn: null,
    createdUserId: null,
    lastUpdateUserRrn: null,
    lastUpdateUserId: null,
    transId: null,
    transPerformedby: null,
    flagType: null,
    systemUsed: null,
    dmmType: null,
    attribute1: null,
    attribute2: null,
    attribute3: null,
    attribute4: null,
    attribute5: null,
    facilityId: null,
    facilityRrn: null,
    existFlag: false,
    contentText: null,
    allowableEventsRrn: null,
    allowableEventsId: null,
    maintenanceEngineerRrn: null,
    maintenanceEngineerId: "EE_DIF",
    processUnitFlag: null,
    operationMode: null,
    locationId: null,
    locationRrn: null,
    prevLocationRrn: null,
    entityLocation: null,
    entityPrevLocation: null,
    reticleMoveinFlag: null,
    parentEntityRrn: null,
    parentEntityId: null,
    lastEventRrn: null,
    attachmentFlag: null,
    lastTransRrn: null,
    executionRrn: null,
    keyEntityFlag: null,
    chamberType: null,
    availability: null,
    documents: [],
    childChambers: [],
    constraints: [],
    entitycounters: [],
    pmschedules: [],
    entitystatuss: [],
    reservations: [],
    reticleFamilyRrn: 0,
    productRrn: 0,
    maskInspectionId: null,
    version: null,
    grade: null,
    status: null,
    maskHouse: null,
    maskHouseStatus: null,
    stpType: null,
    maskType: null,
    magnification: null,
    createUserRrn: 200,
    createDateTime: null,
    maskSize: null,
    pellicle: null,
    reticleFamilyId: null,
    product: null,
    createUser: null,
    reticleFamily: null,
    reticleMakingDate: null,
    equipmentLocation: "DF",
    equipmentOwner: null,
    equipmentWph: null,
    equipmentCapability: null,
    equipmentModel: null,
    pollutionLevel: null,
    childChamberType: null,
    maxUseTimes: null,
    currentUseTimes: null,
    processTime: null,
    pdTime: null,
    overdueTime: null,
    entitieGroups: [],
    currentStatus: null,
    moveNextPollutionLevels: null,
    isPlOpen: null,
    isMoveNeitPlOpen: null,
    pmHoldFlag: false,
    defaultEquipConstrain: null,
    isChamberEquip: null,
    chamberMode: null,
    attributeData1: null,
    attributeData2: null,
    attributeData3: null,
    attributeData4: null,
    attributeData5: null,
    attributeData6: null,
    reticleType: null,
    qcFlowId: null,
    testType: null,
    selectWafersFlag: null,
    aeqpFlag: null,
    errorMsg: {},
    pmRrn: 15620880,
    pmId: "AESH001换液",
    objectRrn: 10488416,
    objectId: "DDP03D",
    chamberId: "",
    pmType: "BY_RECIPE",
    pmItemDesc: null,
    cycleTime: 0.0,
    durationTime: 0.0,
    nextPmTime: "9999/12/12 00:00:00",
    lastPmTime: null,
    toleranceTime: 0.0,
    cycleCount: 0.0,
    durationCount: 10000.0,
    currentPmCount: 10000.0,
    toleranceCount: 0.0,
    cycleOther: null,
    durationOther: null,
    currentPmOther: null,
    toleranceOther: null,
    itemStatus: "ON",
    createUserId: "ADMIN",
    createDate: "2024-10-25",
    chamberRrn: 0,
    emailIntervalTime: 6,
    transRrn: null,
    pmRrnStr: null,
    eqptStatus: "SPC_HOLD",
    objectStatus: "SPC_HOLD",
    chamberStatus: null,
    startDate: null,
    endDate: null,
    targetEventId: null,
    station: "ALL,EE_DIF,MGF_DF,PE_DF",
    pmEnd: null,
    toleranceStatus: 0,
    comment: null,
    subNextPmTimeStr: "00:00",
    nextPmTimeStr: "9999/12/12",
    inUserLocation: 1,
    userLocation: null,
    prePMTimee: "9999/12/12 00:00:00",
    deadLine: "9999/12/12 00:00:00",
    controlType: "PM_COUNT",
    totalCount: 1.0e7,
    alarmCount: 2500000.0,
    checklistId: "低压炉管--月度保养",
    checklistRrn: 10498696,
    jobCount: null,
    lotCount: null,
    waferCount: null,
    pmTimeType: null,
    pmLink: null,
    pmLinks: null,
    seq: null,
    autoEqpStatus: "YES",
    pmReminder: "3",
    partConsume: null,
    partConsumeMap: null,
    checkListItems: null,
    conditionQty: null,
    conditionList: null,
    checklistItemId: null,
    checklistJobState: null,
    recipeType: "BY_FILM_THICKNESS",
    recipeCountType: "BY_JOB",
    checklistJobRrn: 0,
    pdflag: null,
    pmengineerRrn: null,
    pmengineerId: null,
    qcengineerId: null,
    qcengineerRrn: null
  },
  {
    instanceRrn: 0,
    instanceId: null,
    lockVersion: 0,
    namedSpace: null,
    instanceDesc: null,
    instanceLongDesc: null,
    object: null,
    objectType: "EQPT",
    objectSubtype: null,
    currentVersion: null,
    activeVersion: null,
    roleRrn: null,
    roleId: null,
    instanceStatus: null,
    createdTimestamp: null,
    lastUpdateTimestamp: null,
    createdTime: null,
    lastUpdateTime: null,
    createdUserRrn: null,
    createdUserId: null,
    lastUpdateUserRrn: null,
    lastUpdateUserId: null,
    transId: null,
    transPerformedby: null,
    flagType: null,
    systemUsed: null,
    dmmType: null,
    attribute1: null,
    attribute2: null,
    attribute3: null,
    attribute4: null,
    attribute5: null,
    facilityId: null,
    facilityRrn: null,
    existFlag: false,
    contentText: null,
    allowableEventsRrn: null,
    allowableEventsId: null,
    maintenanceEngineerRrn: null,
    maintenanceEngineerId: "EE_ETH",
    processUnitFlag: null,
    operationMode: null,
    locationId: null,
    locationRrn: null,
    prevLocationRrn: null,
    entityLocation: null,
    entityPrevLocation: null,
    reticleMoveinFlag: null,
    parentEntityRrn: null,
    parentEntityId: null,
    lastEventRrn: null,
    attachmentFlag: null,
    lastTransRrn: null,
    executionRrn: null,
    keyEntityFlag: null,
    chamberType: null,
    availability: null,
    documents: [],
    childChambers: [],
    constraints: [],
    entitycounters: [],
    pmschedules: [],
    entitystatuss: [],
    reservations: [],
    reticleFamilyRrn: 0,
    productRrn: 0,
    maskInspectionId: null,
    version: null,
    grade: null,
    status: null,
    maskHouse: null,
    maskHouseStatus: null,
    stpType: null,
    maskType: null,
    magnification: null,
    createUserRrn: 10492756,
    createDateTime: null,
    maskSize: null,
    pellicle: null,
    reticleFamilyId: null,
    product: null,
    createUser: null,
    reticleFamily: null,
    reticleMakingDate: null,
    equipmentLocation: "ET",
    equipmentOwner: null,
    equipmentWph: null,
    equipmentCapability: null,
    equipmentModel: null,
    pollutionLevel: null,
    childChamberType: null,
    maxUseTimes: null,
    currentUseTimes: null,
    processTime: null,
    pdTime: null,
    overdueTime: null,
    entitieGroups: [],
    currentStatus: null,
    moveNextPollutionLevels: null,
    isPlOpen: null,
    isMoveNeitPlOpen: null,
    pmHoldFlag: false,
    defaultEquipConstrain: null,
    isChamberEquip: null,
    chamberMode: null,
    attributeData1: null,
    attributeData2: null,
    attributeData3: null,
    attributeData4: null,
    attributeData5: null,
    attributeData6: null,
    reticleType: null,
    qcFlowId: null,
    testType: null,
    selectWafersFlag: null,
    aeqpFlag: null,
    errorMsg: {},
    pmRrn: 15617406,
    pmId: "AECH004换液",
    objectRrn: 10488632,
    objectId: "CSC001",
    chamberId: "",
    pmType: "DAYS",
    pmItemDesc: null,
    cycleTime: 24.0,
    durationTime: 1.0,
    nextPmTime: "2024/11/17 09:21:47",
    lastPmTime: "2024/10/24 09:21:47",
    toleranceTime: 23.0,
    cycleCount: 0.0,
    durationCount: 0.0,
    currentPmCount: 0.0,
    toleranceCount: 0.0,
    cycleOther: null,
    durationOther: null,
    currentPmOther: null,
    toleranceOther: null,
    itemStatus: "ON",
    createUserId: "0125889",
    createDate: "2024-10-24",
    chamberRrn: 0,
    emailIntervalTime: 6,
    transRrn: null,
    pmRrnStr: null,
    eqptStatus: "PM",
    objectStatus: "PM",
    chamberStatus: null,
    startDate: null,
    endDate: null,
    targetEventId: null,
    station: "ALL,EE_ETH,MFG_WET,PE_ET",
    pmEnd: null,
    toleranceStatus: 1,
    comment: ".",
    subNextPmTimeStr: "09:21",
    nextPmTimeStr: "2024/11/17",
    inUserLocation: 1,
    userLocation: null,
    prePMTimee: "2024/11/16 10:21:47",
    deadLine: "2024/11/18 08:21:47",
    controlType: "PM_TIME",
    totalCount: 0.0,
    alarmCount: 0.0,
    checklistId: "SSW-629擦片机日常检点",
    checklistRrn: 10624210,
    jobCount: null,
    lotCount: null,
    waferCount: null,
    pmTimeType: "Static",
    pmLink: null,
    pmLinks: null,
    seq: null,
    autoEqpStatus: "NO",
    pmReminder: "3",
    partConsume: null,
    partConsumeMap: null,
    checkListItems: null,
    conditionQty: null,
    conditionList: null,
    checklistItemId: null,
    checklistJobState: "STARTED",
    recipeType: null,
    recipeCountType: null,
    checklistJobRrn: 15627369,
    pdflag: null,
    pmengineerRrn: null,
    pmengineerId: null,
    qcengineerId: null,
    qcengineerRrn: null
  }
]

const matDatas = [
  { matId: 100001, matDesc: "工艺耗材001", qty: 100 },
  { matId: 100002, matDesc: "工艺耗材002", qty: 100 },
  { matId: 100003, matDesc: "工艺耗材003", qty: 100 },
  { matId: 100004, matDesc: "工艺耗材004", qty: 100 },
  { matId: 100005, matDesc: "工艺耗材005", qty: 100 },
  { matId: 100006, matDesc: "工艺耗材006", qty: 100 },
  { matId: 100007, matDesc: "工艺耗材007", qty: 100 },
  { matId: 100008, matDesc: "工艺耗材008", qty: 100 },
  { matId: 100009, matDesc: "工艺耗材009", qty: 100 },
  { matId: 100010, matDesc: "工艺耗材010", qty: 100 }
]
function createEqptPMForm() {
  const eqptPMForm = Ext.create("Ext.form.Panel", {
    id: "eqptPMForm",
    bodyPadding: 5,
    width: "100%",
    region: "north",
    layout: "column",
    defaults: {
      labelWidth: 130,
      labelAlign: "right",
      padding: 1
    },
    items: [
      {
        xtype: "mycim.searchfield",
        fieldLabel: "设备",
        name: "objectId",
        type: "EQUIPMENT", //'EQPTNOTCHAMBER''LOGEQUIPMENTEVENTBYUSER',
        targetIds: "objectId",
        columnWidth: 0.25
      },
      {
        xtype: "combobox",
        fieldLabel: "维护类型",
        name: "pmType",
        columnWidth: 0.25,
        editable: false,
        displayField: "data1",
        valueField: "key",
        // store: pmTypeStore(),
        queryMode: "local"
      },
      {
        xtype: "combobox",
        fieldLabel: "设备状态",
        name: "eqptStatus",
        columnWidth: 0.25,
        editable: false,
        displayField: "key",
        valueField: "value",
        // store: comboboxStore(mycim2dev + "/eqptPortal.do?op=combo&type=status", "comboData"),
        queryMode: "local"
      },
      {
        xtype: "combobox",
        fieldLabel: "区域",
        name: "area",
        columnWidth: 0.25,
        editable: false,
        displayField: "key",
        valueField: "value",
        // store: comboboxStore(mycim2dev + "/eqptPortal.do?op=conditionCombo&type=location", "getConditionCombo"),
        queryMode: "local"
      },
      {
        xtype: "datefield",
        fieldLabel: "开始时间",
        format: "Y/m/d",
        name: "startDate",
        value: "",
        enableKeyEvents: false,
        columnWidth: 0.25
      },
      {
        xtype: "datefield",
        fieldLabel: "结束时间",
        name: "endDate",
        format: "Y/m/d",
        value: "",
        enableKeyEvents: false,
        columnWidth: 0.25
      },
      {
        xtype: "combobox",
        fieldLabel: "ON/OFF",
        name: "itemStatus",
        columnWidth: 0.25,
        editable: false,
        displayField: "key",
        valueField: "value",
        store: ["", "ON", "OFF"],
        value: "",
        queryMode: "local"
      },
      {
        xtype: "combobox",
        fieldLabel: "工程师组",
        id: "engineerGroup",
        name: "engineerGroup",
        columnWidth: 0.25,
        editable: false,
        emptyText: "--" + i18n_fld_choice + "--",
        displayField: "key",
        valueField: "value",
        // store: Ext.create("Ext.data.Store", {
        //   fields: ["key", "value"],
        //   proxy: {
        //     type: "ajax",
        //     actionMethods: { read: "GET" },
        //     url: "/" + APP_NAME + "/eqptPortal.do?type=engineer",
        //     requestMethod: "getConditionCombo",
        //     queryMask: false
        //   },
        //   autoLoad: true
        // }),
        queryMode: "local"
      }
    ],
    buttons: [
      {
        text: "查看",
        formBind: true,
        disabled: true,
        region: "center",
        iconCls: "iconCls_magnifier"
        // handler: me.doSearch
      },
      {
        text: "清空信息",
        formBind: true,
        disabled: true,
        region: "center",
        iconCls: "iconCls_arrowRedo"
        // handler: me.doClear
      }
    ]
  })
  return eqptPMForm
}

function createEqptPMGrid() {
  const eqptPMStore = createEqptPMStore()
  const eqptPMGrid = Ext.create("Ext.grid.Panel", {
    id: "eqptPMGrid",
    store: eqptPMStore,
    width: "100%",
    region: "center",
    // selModel: new Ext.selection.CheckboxModel({ checkOnly: true }),
    // multiSelect: true,
    columnLines: true,
    stripeRows: true,
    dockedItems: [
      {
        xtype: "toolbar",
        id: "parameterToolbars",
        items: [
          {
            itemId: "addAMTimeBtn",
            text: "AM Time",
            iconCls: "iconCls_add",
            handler: function () {
              showEditWindow("AMTime")
            }
          },
          {
            itemId: "addAMCountBtn",
            text: "AM Count",
            iconCls: "iconCls_add",
            handler: function () {
              showEditWindow("AMCount")
            }
          },
          {
            itemId: "hyStartBtn",
            text: "开始换液",
            handler: function () {}
          },
          {
            itemId: "hyEndBtn",
            text: "结束换液",
            handler: function () {}
          },
          {
            itemId: "onOffBtn",
            text: "ON/OFF",
            handler: function () {}
          },
          {
            itemId: "deleteBtn",
            text: "删除",
            iconCls: "iconCls_delete",
            handler: function () {}
          },
          {
            itemId: "export",
            text: i18n.labels.LBS_EXPORT,
            scope: this,
            iconCls: "iconCls_pageExcel",
            handler: function () {}
          }
        ]
      },
      {
        xtype: "mycim.pagingtoolbar",
        id: "pmsPagingTool",
        store: eqptPMStore,
        dock: "bottom",
        displayInfo: true,
        displayMsg: i18n_fld_showThe + "{0}" + i18n_fld_to + "{1}," + i18n_fld_total + "{2}" + i18n_fld_tiao,
        emptyMsg: i18n.msgs.MSG_NO_RESULT
      }
    ],
    selModel: Ext.create("Ext.selection.CheckboxModel", {
      injectCheckbox: 1, // 复选框的列索引位置，从0开始
      checkOnly: true // 为true，则只能通过点击CheckBox列进行选择操作
      /*renderer: function (){
          return '';
        }*/
    }),
    columns: [
      {
        xtype: "rownumberer",
        header: i18n.labels.LBL_SEQ,
        menuDisabled: true,
        dataIndex: "iconSelect",
        width: 50,
        id: "IconSelect"
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmRrn",
        header: "",
        hidden: true,
        width: 30
      },
      {
        xtype: "gridcolumn",
        dataIndex: "checklistJobRrn",
        header: "",
        hidden: true,
        width: 30
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmId",
        menuDisabled: true,
        header: i18n.labels.LBL_PM_ID,
        width: 120
      },
      {
        xtype: "gridcolumn",
        dataIndex: "objectId",
        header: i18n.labels.LBL_EQPT_ID,
        width: 120
      },
      {
        xtype: "gridcolumn",
        dataIndex: "chamberId",
        header: i18n.labels.LBS_CHAMBER_EQUIPMENT,
        width: 60,
        hidden: true
      },
      {
        xtype: "gridcolumn",
        dataIndex: "checklistId",
        menuDisabled: true,
        header: "换液清单号",
        width: 100
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmType",
        header: i18n.labels.LBS_PM_TYPE,
        menuDisabled: true,
        width: 100
      },
      {
        xtype: "gridcolumn",
        dataIndex: "controlType",
        menuDisabled: true,
        header: i18n.labels.LBL_CONTROL_TYPE,
        width: 80
      },
      {
        xtype: "gridcolumn",
        menuDisabled: true,
        dataIndex: "totalCount",
        header: i18n.labels.LBL_TOTAL_COUNT,
        width: 80
      },
      {
        xtype: "gridcolumn",
        menuDisabled: true,
        dataIndex: "alarmCount",
        header: i18n.labels.LBL_ALARM_COUNT,
        width: 80
      },
      {
        xtype: "gridcolumn",
        menuDisabled: true,
        dataIndex: "currentPmCount",
        header: i18n.labels.LBL_CURRENT_PM_COUNT,
        width: 80
      },
      {
        xtype: "gridcolumn",
        dataIndex: "eqptStatus",
        menuDisabled: true,
        header: i18n_fld_eqptStatus,
        width: 100
      },
      {
        xtype: "gridcolumn",
        dataIndex: "maintenanceEngineerId",
        header: i18n.labels.LBL_ENGINEER_GROUP_ID,
        sortable: true,
        width: 100,
        align: "left",
        id: "maintenanceEngineerId"
      },
      {
        xtype: "gridcolumn",
        dataIndex: "equipmentLocation",
        menuDisabled: true,
        header: i18n_fld_location,
        width: 80
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmItemDesc",
        menuDisabled: true,
        header: i18n.labels.LBL_DESCRIPTION,
        width: 100
      },
      {
        xtype: "gridcolumn",
        dataIndex: "createUserId",
        header: i18n.labels.LBS_CREATE_BY,
        width: 85
      },
      {
        xtype: "gridcolumn",
        dataIndex: "cycleTime",
        menuDisabled: true,
        header: i18n.labels.LBS_CYCLE_TIME,
        width: 80,
        renderer: function (value, metadata, record, rowIndex, colIndex, store) {
          if (record.getData().controlType === "PM_COUNT") {
            return ""
          } else {
            return value
          }
        }
      },
      {
        xtype: "gridcolumn",
        dataIndex: "lastPmTime",
        menuDisabled: true,
        header: i18n.labels.LBS_PRE_NEXT_PM_TIME,
        width: 150
      },
      {
        xtype: "gridcolumn",
        dataIndex: "nextPmTime",
        menuDisabled: true,
        header: i18n.labels.LBS_NEXT_PM_TIME,
        width: 150,
        renderer: function (value, metadata, record, rowIndex, colIndex, store) {
          if (record.getData().controlType === "PM_COUNT") {
            return ""
          } else {
            return value
          }
        }
      },
      {
        xtype: "gridcolumn",
        dataIndex: "deadLine",
        menuDisabled: true,
        header: i18n.labels.LBS_POST_NEXT_PM_TIME,
        width: 150,
        renderer: function (value, metadata, record, rowIndex, colIndex, store) {
          if (record.getData().controlType === "PM_COUNT") {
            return ""
          } else {
            return value
          }
        }
      },
      {
        xtype: "gridcolumn",
        dataIndex: "toleranceTime",
        menuDisabled: true,
        header: i18n.labels.LBS_TOLERANCE_TIME,
        width: 88,
        renderer: function (value, metadata, record, rowIndex, colIndex, store) {
          if (record.getData().controlType === "PM_COUNT") {
            return ""
          } else {
            return value
          }
        }
      },
      {
        xtype: "gridcolumn",
        dataIndex: "durationTime",
        menuDisabled: true,
        header: i18n.labels.LBS_DURATION_TIME,
        width: 88,
        renderer: function (value, metadata, record, rowIndex, colIndex, store) {
          if (record.getData().controlType === "PM_COUNT") {
            return ""
          } else {
            return value
          }
        }
      },
      {
        xtype: "gridcolumn",
        dataIndex: "itemStatus",
        menuDisabled: true,
        header: i18n.labels.LBS_PM_ON_OFF,
        width: 75
      },
      {
        xtype: "gridcolumn",
        dataIndex: "autoEqpStatus",
        menuDisabled: true,
        header: i18n.labels.LBL_AUTO_SWITCH_EQUIPMENT_STATUS,
        width: 75
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmReminder",
        menuDisabled: true,
        header: i18n.labels.LBL_PM_REMINDER,
        width: 75
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmTimeType",
        hidden: true
      },
      {
        xtype: "gridcolumn",
        dataIndex: "pmLinks",
        hidden: true,
        listeners: {}
      },
      {
        xtype: "gridcolumn",
        dataIndex: "conditionQty",
        hidden: true
      },
      {
        xtype: "gridcolumn",
        dataIndex: "comment",
        header: i18n.labels.LBL_COMMENT,
        hidden: true
      }
    ]
  })

  eqptPMGrid.on({
    itemdblclick: function (grid, record, item, rowindex, e, opts) {
      showHYDetailTab(grid, record, item, rowindex, e, opts)
    }
  })
  return eqptPMGrid
}

function createEqptPMStore() {
  const eqptPMStore = Ext.create("Ext.data.Store", {
    storeId: "eqptPMStore",
    fields: [
      {
        name: "pmRrn"
      },
      {
        name: "pmId"
      },
      {
        name: "objectId"
      },
      {
        name: "chamberId"
      },
      {
        name: "pmType"
      },
      {
        name: "eqptStatus"
      },
      {
        name: "maintenanceEngineerId"
      },
      {
        name: "pmItemDesc"
      },
      {
        name: "createUserId"
      },
      {
        name: "cycleTime"
      },
      {
        name: "nextPmTime"
      },
      {
        name: "toleranceTime"
      },
      {
        name: "durationTime"
      },
      {
        name: "itemStatus"
      },
      {
        name: "autoEqpStatus"
      },
      {
        name: "toleranceStatus"
      },
      {
        name: "nextPmTimeStr"
      },
      {
        name: "subNextPmTimeStr"
      },
      {
        name: "inUserLocation"
      },
      {
        name: "lastPmTime"
      },
      {
        name: "deadLine"
      },
      {
        name: "station"
      },
      {
        name: "controlType"
      },
      {
        name: "totalCount"
      },
      {
        name: "alarmCount"
      },
      {
        name: "currentPmCount"
      },
      {
        name: "checklistId"
      },
      {
        name: "checklistJobRrn"
      },
      {
        name: "pmTimeType"
      },
      {
        name: "equipmentLocation"
      },
      {
        name: "pmLinks"
      },
      {
        name: "consumePartStatus"
      },
      {
        name: "conditionQty"
      },
      {
        name: "comment"
      },
      {
        name: "recipeType"
      },
      {
        name: "recipeCountType"
      },
      { name: "pmReminder" }
    ],
    data: datas
  })
  return eqptPMStore
}

function showEditWindow(type) {
  //AMTime  AMCount
  var baseForm = Ext.create("Ext.form.Panel", {
    id: "eqptPMWindowForm",
    autoScroll: true,
    defaults: {
      anchor: "100%"
    },
    fieldDefaults: {
      labelAlign: "left",
      flex: 1,
      margin: 5
    },
    items: [
      {
        xtype: "container",
        layout: "column",
        defaults: {
          labelWidth: 150,
          columnWidth: 0.5
        },
        items: [
          {
            xtype: "textfield",
            hidden: true,
            id: "pmRrn",
            name: "pmRrn",
            itemId: "pmRrn"
          },
          {
            xtype: "textfield",
            fieldLabel: "换液ID",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: false,
            name: "pmId",
            itemId: "pmId"
          },
          {
            xtype: "mycim.searchfield",
            fieldLabel: "设备号",
            allowBlank: false,
            id: "objectId",
            name: "objectId",
            itemId: "objectId",
            // type: eqptSearchType,
            targetIds: "objectId"
          },
          {
            xtype: "combobox",
            fieldLabel: "维护类型",
            style: "margin-left:150px;margin-top:20px",
            name: "pmType",
            itemId: "pmType",
            id: "pmType",
            editable: false,
            allowBlank: false,
            displayField: "data1",
            valueField: "key",
            // store: pmTypeStore(type),
            queryMode: "local"
          },
          {
            xtype: "numberfield",
            fieldLabel: "换液时间间隔",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: false,
            name: "cycleTime",
            itemId: "cycleTime",
            allowDecimals: false, // 是否允许输入小数
            minValue: 1,
            hidden: type !== "AMTime"
          },
          {
            xtype: "textfield",
            fieldLabel: "描述",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: true,
            name: "desc",
            id: "desc",
            hidden: type !== "AMCount"
          },
          {
            xtype: "mycim.combobox",
            name: "checklistId",
            id: "checklistId",
            itemId: "checklistId",
            editable: false,
            fieldLabel: "换液清单号",
            queryMode: "local",
            allowBlank: false
          },
          {
            xtype: "textfield",
            name: "nexthyTime",
            style: "margin-left:150px;margin-top:20px",
            id: "nexthyTime",
            fieldLabel: "下次换液时间",
            allowBlank: false,
            hidden: type !== "AMTime"
          },
          {
            xtype: "combobox",
            fieldLabel: "维护时间类型",
            style: "margin-left:150px;margin-top:20px",
            name: "pmTimeType",
            editable: false,
            displayField: "data1",
            valueField: "key",
            queryMode: "local",
            hidden: type !== "AMTime"
          },
          {
            xtype: "numberfield",
            fieldLabel: "总数量",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: false,
            name: "totalCount",
            itemId: "totalCount",
            allowDecimals: true, // 是否允许输入小数
            minValue: 0,
            hidden: type !== "AMCount"
          },
          {
            xtype: "numberfield",
            fieldLabel: "警报数量",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: false,
            name: "alarmCount",
            itemId: "alarmCount",
            allowDecimals: true, // 是否允许输入小数
            minValue: 0,
            hidden: type !== "AMCount"
          },
          {
            xtype: "combobox",
            fieldLabel: "自动切换设备",
            name: "autoEqp",
            itemId: "autoEqp",
            editable: false,
            allowBlank: false,
            displayField: "key",
            valueField: "value",
            store: ["YES", "NO"],
            value: "NO",
            queryMode: "local"
          },
          {
            xtype: "combobox",
            fieldLabel: "ON/OFF",
            style: "margin-left:150px;margin-top:20px",
            name: "itemStatus",
            itemId: "itemStatus",
            id: "itemStatus",
            editable: false,
            allowBlank: false,
            displayField: "key",
            valueField: "value",
            store: ["ON", "OFF"],
            value: "ON",
            queryMode: "local"
          },
          {
            xtype: "combobox",
            fieldLabel: "自动切换状态",
            style: "margin-left:150px;margin-top:20px",
            name: "autoEqpStatus",
            itemId: "autoEqpStatus",
            editable: false,
            allowBlank: false,
            displayField: "key",
            valueField: "value",
            store: ["YES", "NO"],
            value: "NO",
            queryMode: "local"
          },
          {
            xtype: "numberfield",
            fieldLabel: "邮件间隔时间(Hour)",
            style: "margin-left:150px;margin-top:20px",
            allowBlank: false,
            name: "emailIntervalTime",
            itemId: "emailIntervalTime",
            allowDecimals: false, // 是否允许输入小数
            minValue: 1,
            value: "6"
          },
          {
            xtype: "numberfield",
            fieldLabel: "提醒时间",
            style: "margin-left:150px;margin-top:20px",
            name: "pmReminder",
            itemId: "pmReminder",
            allowDecimals: false, // 是否允许输入小数
            allowBlank: false,
            minValue: 1,
            value: "3",
            hidden: type !== "AMTime"
          },
          {
            xtype: "textareafield",
            grow: false,
            name: "comment",
            itemId: "comment",
            fieldLabel: "备注",
            anchor: "100%",
            columnWidth: 1,
            readOnly: false,
            fieldStyle: "",
            height: 100,
            resizable: false //textarea 输入框是否可拖拽
          }
        ]
      }
    ]
  })

  const loadMarsk = new Ext.LoadMask(Ext.getCmp("eqptPMWindowForm"), {
    msg: i18n.msgs.MSG_PROCESSING_PLEASE_WAITTING,
    wait: true
  })

  Ext.create("Ext.window.Window", {
    width: 950,
    height: 500,
    modal: true, // 是否需要遮罩
    layout: "fit",
    modal: true, // 模态化窗口
    closable: true,
    constrain: true, // 限制窗口拖动范围
    resizable: false,
    title: "新增",
    constrain: true, // 限制窗口拖动范围
    id: "eqptPMWindow",
    items: [baseForm],
    buttons: [
      {
        text: "保存",
        formBind: true,
        handler: function () {}
      },
      {
        text: "重置",
        style: "margin-left:10px",
        id: "resetBtn",
        handler: function () {}
      },
      {
        text: "取消",
        style: "margin-left:10px",
        handler: function () {}
      }
    ]
  }).show()
}

function createEqptMainPanel() {
  const eqptMainPanel = Ext.create("Ext.panel.Panel", {
    layout: { type: "border" },
    items: [createEqptPMForm(), createEqptPMGrid()]
  })
  return eqptMainPanel
}

function createEqptTabPanel() {
  const eqptTabPanel = Ext.create("Ext.tab.Panel", {
    region: "center",
    id: "eqptTabPanel",
    activeTab: 0,
    items: [
      //选项卡中的每一项选项设置
      {
        closable: false,
        layout: "fit",
        tabConfig: {
          title: "<span>" + "换液检查Portal" + "</span>"
        },
        items: [createEqptMainPanel()]
      }
    ],
    listeners: {}
  })
  return eqptTabPanel
}

function createHYDetailPanel() {
  const hYDetailPanel = Ext.create("Ext.panel.Panel", {
    layout: { type: "border" },
    items: [createHyBasicDetailForm(), createSuppliesPanel()]
  })
  return hYDetailPanel
}

function createHyBasicDetailForm() {
  const hyBasicDetailForm = Ext.create("Ext.form.Panel", {
    name: "hyBasicDetailForm",
    title: "基本信息",
    frame: true,
    width: 320,
    region: "west",
    bodyPadding: 10,
    defaultType: "textfield",
    defaults: {
      anchor: "100%"
    },
    items: [
      {
        fieldLabel: "设备号",
        name: "eqptId",
        readOnly: true,
        value: "ECL001"
      },
      {
        allowBlank: false,
        fieldLabel: "换液号",
        name: "pmId",
        readOnly: true,
        value: "HYID001"
      },
      {
        fieldLabel: "换液检查单号",
        name: "checkListId",
        readOnly: true,
        value: "CKL0001"
      },
      {
        fieldLabel: "检查列表状态",
        name: "checkListStatus",
        readOnly: true,
        value: "STARTED"
      }
    ]
  })
  return hyBasicDetailForm
}

function createSuppliesStore() {
  const suppliesStore = Ext.create("Ext.data.Store", {
    storeId: "suppliesStore",
    fields: ["matId", "matDesc", "qty"],
    data: matDatas
  })
  return suppliesStore
}

function createSuppliesGrid() {
  const suppliesStore = createSuppliesStore()
  const suppliesGrid = Ext.create("Ext.grid.Panel", {
    name: "suppliesGrid",
    store: suppliesStore,
    width: "100%",
    region: "north",
    flex: 5,
    title: "工艺耗材",
    columns: [
      { dataIndex: "matId", align: "left", flex: 1, text: "工艺耗材号" },
      { dataIndex: "matDesc", align: "left", flex: 1, text: "工艺耗材描述" },
      { dataIndex: "qty", align: "left", flex: 1, text: "标准用量" },
      {
        text: "操作",
        renderer: function (val, meta, rec) {
          // 为元素生成唯一id
          var id = Ext.id()
          Ext.defer(function () {
            Ext.widget("button", {
              renderTo: id,
              text: "消耗",
              scale: "small",
              width: 40,
              height: 20,
              handler: function () {}
            })
          }, 50)
          return Ext.String.format('<div id="{0}"></div>', id)
        }
      }
    ]
  })
  return suppliesGrid
}

function createLotNumberStore() {
  const lotNumbeStore = Ext.create("Ext.data.Store", {
    storeId: "lotNumbeStore",
    fields: ["matId", "matDesc", "lotNumber", "qty"]
  })
  return lotNumbeStore
}

function createSuppliesLotNumberGrid() {
  const lotNumbeStore = createLotNumberStore()
  const lotNumbeGrid = Ext.create("Ext.grid.Panel", {
    name: "lotNumbeGrid",
    store: lotNumbeStore,
    width: "100%",
    region: "south",
    flex: 5,
    title: "批次消耗",
    region: "center",
    columns: [
      { dataIndex: "matId", align: "left", flex: 1, text: "工艺耗材号" },
      { dataIndex: "matDesc", align: "left", flex: 1, text: "工艺耗材描述" },
      { dataIndex: "lotNumber", align: "left", flex: 1, text: "批次号" },
      { dataIndex: "qty", align: "left", flex: 1, text: "消耗数量" },
      { align: "left", flex: 1, text: "操作" }
    ]
  })
  return lotNumbeGrid
}

function createSuppliesPanel() {
  const suppliesPanel = Ext.create("Ext.panel.Panel", {
    region: "center",
    layout: { type: "border" },
    items: [createSuppliesGrid(), createSuppliesLotNumberGrid()]
  })
  return suppliesPanel
}
