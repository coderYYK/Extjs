Ext.ns("Ext.ux.plugins.grid");Ext.ux.plugins.grid.CellToolTips=function(b){var a;if(Ext.isArray(b)){a=b;b={}}else{a=b.ajaxTips}Ext.ux.plugins.grid.CellToolTips.superclass.constructor.call(this,b);if(b.tipConfig){this.tipConfig=b.tipConfig}this.ajaxTips=a};Ext.extend(Ext.ux.plugins.grid.CellToolTips,Ext.util.Observable,{version:1.3,ajaxTips:false,tipTpls:false,tipFns:false,tipUrls:"",tipConfig:{},request:false,init:function(a){if(!this.ajaxTips){return}this.tipTpls={};this.tipFns={};this.tipAfterFns={};this.tipUrls={};Ext.each(this.ajaxTips,function(b){this.tipTpls[b.field]=new Ext.XTemplate(b.tpl);if(b.url){this.tipUrls[b.field]=b.url}if(b.fn){this.tipFns[b.field]=b.fn}if(b.afterFn){this.tipAfterFns[b.field]=b.afterFn}if(b.tipConfig){this.tipConfig=b.tipConfig}},this);delete (this.ajaxTips);a.on("render",this.onGridRender.createDelegate(this))},setFieldTpl:function(b,a){this.tipTpls[b]=Ext.isObject(a)?a:new Ext.XTemplate(a)},onGridRender:function(a){if(!this.tipTpls){return}Ext.apply(this.tipConfig,{target:a.getView().mainBody,delegate:".x-grid3-cell-inner",renderTo:document.body,finished:false});Ext.applyIf(this.tipConfig,{trackMouse:true});this.tip=new Ext.ToolTip(this.tipConfig);this.tip.ctt=this;this.tip.on("beforeshow",this.beforeTipShow.createDelegate(this.tip,[this,a],true));this.tip.on("hide",this.hideTip)},beforeTipShow:function(i,b,a){var e=a.getView().findCellIndex(i.triggerElement);var c=a.getColumnModel().getDataIndex(e);if(!b.tipTpls[c]){return false}if(!i.finished){var g=(typeof b.tipUrls[c]=="string");var h=a.getView().findRowIndex(i.triggerElement);var f=a.getStore().getAt(h);if(a.CellToolTipCondition&&a.CellToolTipCondition(h,f)===false){return false}var d=f.copy().data;if(g){b.loadDetails((b.tipFns[c])?b.tipFns[c](d):d,i,a,b,c);i.body.dom.innerHTML="Loading..."}else{i.body.dom.innerHTML=b.tipTpls[c].apply((b.tipFns[c])?b.tipFns[c](f.copy().data):f.copy().data)}}else{i.body.dom.innerHTML=i.ctt.tipTpls[c].apply(i.tipdata)}},hideTip:function(a){a.finished=false},loadDetails:function(d,c,a,b,e){Ext.Ajax.request({url:b.tipUrls[e],params:d,method:"POST",success:function(g,f){c.finished=true;c.tipdata=Ext.decode(g.responseText);if(b.tipAfterFns[e]){c.tipdata=b.tipAfterFns[e](c.tipdata)}c.show()}})}});