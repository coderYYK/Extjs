<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <table width="100%" border="0" style="border-spacing: 2px 2px">
      <tr style="height: 30px; background-color: #ebeff4">
        <td class="lotid-td">HA21A0897</td>
        <td><input class="item-input" type="text" style="background-color: #a6f9d7" placeholder="820001000010" /></td>
      </tr>
      <tr style="height: 30px; background-color: #ebeff4">
        <td class="lotid-td">HA21A0898</td>
        <td><input class="item-input" type="text" placeholder="820001000011" /></td>
        <td><input class="item-input" type="text" placeholder="820001000012" /></td>
        <td><input class="item-input" type="text" placeholder="820001000012" /></td>
        <td><input class="item-input" type="text" placeholder="820001000012" /></td>
        <td><input class="item-input" type="text" placeholder="820001000012" /></td>
      </tr>
    </table>
    <button onclick="xxx()">xxxxx</button>
  </body>

  <script type="text/javascript" src="../../link-js/jquery/jquery-1.8.3.js"></script>
  <script>
    $(function () {
      var inputs = $(".item-input")
      // 遍历找到的元素并获取值
      inputs.each(function () {
        $(this).keyup(function (event) {
          if (event.keyCode === 13) {
            alert("你输入的内容为：" + $(this).attr("placeholder") + "," + $(this).val())
          }
        })
      })
    })
    function xxx() {
      const datas = [
        { lotItems: [{ itemId: "820001000010", itemRrn: 10505849 }], lotId: "HA21A0897" },
        {
          lotItems: [
            { itemId: "820001000010", itemRrn: 10505849 },
            { itemId: "820001000010", itemRrn: 10505849 }
          ],
          lotId: "HA21A0898"
        }
      ]
      const inputs = $(".item-input")
      const ndatas = {}
      datas.forEach((data) => {
        ndatas[data.lotId] = data.lotItems.map((l) => l.itemId)
      })
      console.log("ndatas", ndatas)

      let result = true
      inputs.each(function () {
        const lotId = $(this).parent().parent().children(".lotid-td")[0].innerText
        const itemId = $(this).val()
        if (!itemId) {
          result = false
          alert("请扫描料号!")
          return false
        }
        const itemArray = ndatas[lotId]
        if (!itemArray.includes(itemId)) {
          result = false
          alert(itemId + ",不在批次物料列表中,请检查!")
          return false
        }
      })
      if (!result) return false
      alert("XXXXX!")
    }
  </script>
</html>
